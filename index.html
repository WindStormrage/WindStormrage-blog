<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-logo.png">
  <link rel="mask-icon" href="/images/favicon-logo.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="WindStormrage Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="WindStormrage Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="WindStormrage">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>WindStormrage Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">WindStormrage Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/07/D3%E4%B9%8B%E4%B8%80%E4%B8%AA%E5%9B%BE%E8%A1%A8%E7%9A%84%E8%AF%9E%E7%94%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/07/D3%E4%B9%8B%E4%B8%80%E4%B8%AA%E5%9B%BE%E8%A1%A8%E7%9A%84%E8%AF%9E%E7%94%9F/" class="post-title-link" itemprop="url">D3之一个图表的诞生</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-09-07 11:35:00 / 修改时间：11:35:40" itemprop="dateCreated datePublished" datetime="2021-09-07T11:35:00+08:00">2021-09-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>注：本文主要是在分享中使用，如果只是看本文的话最好是拿出编辑器跟着我的代码copy也好，对着敲也好，这样才更加了解我在说什么，完整代码<a href="https://github.com/WindStormrage/my_d3_demo/tree/main/%E6%95%99%E5%AD%A6%E5%9B%BE%E8%A1%A8" target="_blank" rel="noopener">在这</a>，文章里面的链接也可以点击去试一试，放心，试出了问题才会想办法去解决~</p>
</blockquote>
<h1 id="D3是什么"><a href="#D3是什么" class="headerlink" title="D3是什么"></a>D3是什么</h1><p><strong>D3</strong>的全称是Data-Driven Document，可见D3是一个基于数据来操作文档的js库。他可以帮助你使用HTML，CSS，SVG甚至是Canvas来展示数据。D3操作SVG的写法像是JQuery，可以对元素添加删除和属性设置，不过D3可以将数据绑定到DOM上，然后根据数据来计算DOM的展示效果，这就是D3的数据驱动。D3不依赖任何库，而且D3不只是一个单独的库，你可以按需加载D3中任意一个单独的模块去使用。</p>
<h1 id="二、D3能做什么"><a href="#二、D3能做什么" class="headerlink" title="二、D3能做什么"></a>二、D3能做什么</h1><p>我们可以看看D3的<a href="https://observablehq.com/@d3/gallery" target="_blank" rel="noopener">官方示例库</a>，里面不但可以实现动画，交互，有我们常用的柱图，线图，甚至是一些复杂，另类的图表也可以实现出来。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aaa23720f02048c487e87bb620d50362~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/403c2c0895c347bf8faf45af1a1f1eee~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<h1 id="三、其他图表库"><a href="#三、其他图表库" class="headerlink" title="三、其他图表库"></a>三、其他图表库</h1><p>说到可视化图表我们最常用的就是<strong>Echarts</strong>，这个大家都很清楚，上手难度非常低，但是定制化程度也低，往往有想要实现产品的一些特殊的需求，就需要绞尽脑汁的想各种奇淫巧技。</p>
<p>还有就是<strong>G2</strong>，我没用过，只是大概的去了解了一下，它把图表分成了，图形组件（坐标轴、图例、提示信息等）和几何形状（点、线、面），你可以把数据映射到任意的元素上，然后拼凑成想要的图表。显然自由度就比Echarts高一些，同时上手的难度也要高一些，适合团队根据ui需求封装成自己的图表库。</p>
<p>D3的话就我们可以在接下来内容中来了解了解。</p>
<h1 id="四、D3的使用步骤"><a href="#四、D3的使用步骤" class="headerlink" title="四、D3的使用步骤"></a>四、D3的使用步骤</h1><p>下面张图完美的诠释了使用D3去绘制一个图表的所有步骤。<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e67bbf26adf74142839f63d8d6558bce~tplv-k3u1fbpfcp-zoom-1.image" alt="Chart drawing checklist"></p>
<ul>
<li>先得要有数据，获得json或者csv的数据。</li>
<li>定义图表的尺寸和边距。</li>
<li>定义你要绘制图表的画布。</li>
<li>创建图表的比例尺，设置物理像素到图表数据的比例。</li>
<li>使用对应的图表绘制你的数据。</li>
<li>给图表添加一些额外的元素，坐标轴、图例、提示框等。</li>
<li>最后给你的图表加上相应的交互。</li>
</ul>
<p>有了上述的步骤我们应该就了解了D3绘制一个图表的过程，接下来我们就一步步的来实现出我的的第一个D3图表。</p>
<h1 id="五、手把手来做个图"><a href="#五、手把手来做个图" class="headerlink" title="五、手把手来做个图"></a>五、手把手来做个图</h1><h3 id="5-0-基础架子搭建"><a href="#5-0-基础架子搭建" class="headerlink" title="5.0 基础架子搭建"></a>5.0 基础架子搭建</h3><p>首先我们引入D3，在引入了D3后就可以在控制台上输入d3看看我们有没有引入成功，同时可以看见D3下面包含了很多方法。</p>
<p>然后我们创建我们的SVG的元素用来绘制我们的图表，同时给定元素的大小。在script里面定义图表的大小和边距。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 初始化代码 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://lib.baomitu.com/d3/6.7.0/d3.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.svg</span> &#123;</span></span><br><span class="line">    border: 1px solid red;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 创建svg容器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">height</span>=<span class="string">"500"</span> <span class="attr">width</span>=<span class="string">"500"</span> <span class="attr">class</span>=<span class="string">"svg"</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  (<span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 基本容器框架定义</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> width = <span class="number">500</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> height = <span class="number">500</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> padding = <span class="number">50</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> innerWidth = width - padding * <span class="number">2</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> innerHeight = height - padding * <span class="number">2</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> xName = <span class="string">'国家'</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> yName = <span class="string">'🏅'</span></span></span><br><span class="line">    &#125;)()</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-1-加载数据"><a href="#5-1-加载数据" class="headerlink" title="5.1 加载数据"></a>5.1 加载数据</h3><p>架子搭好后我们可以先引入数据看看数据是什么样子的。从这开始我们就正式的接触D3了，数据引入我们使用的是<a href="https://github.com/d3/d3-fetch/tree/v3.0.1" target="_blank" rel="noopener">d3-fetch</a>，他提供了一系列加载数据的方法，可以支持你加载txt、csv、json等各种常用的文件类型。你可以单独引入d3-fetch进行使用，不过我们引入了D3就不单独来引入了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单独引入的例子</span></span><br><span class="line"><span class="keyword">import</span> &#123;csv&#125; <span class="keyword">from</span> <span class="string">"d3-fetch"</span>;</span><br><span class="line">csv(<span class="string">".csv"</span>).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> d3 <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line">d3.csv(<span class="string">"data.csv"</span>).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data); <span class="comment">// [&#123;"key": "value"&#125;, …]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>你可以发现csv方法返回的是一个Promise对象，在D3的v5.x版本采用了Promise来替代之前的异步回调的方式，如果使用的是之前的版本需要注意使用回调函数来获得数据，最好还是使用最新的版本来使用D3。</p>
<p>通过打印我们可以看到数据如下。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[&#123;</span><br><span class="line">  <span class="attr">"序号"</span>: <span class="string">"1"</span>, <span class="attr">"国家"</span>: <span class="string">"🇺🇸"</span>, <span class="attr">"🏅"</span>: <span class="string">"39"</span>,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">"序号"</span>: <span class="string">"2"</span>, <span class="attr">"国家"</span>: <span class="string">"🇨🇳"</span>, <span class="attr">"🏅"</span>: <span class="string">"38"</span>,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">"序号"</span>: <span class="string">"3"</span>, <span class="attr">"国家"</span>: <span class="string">"🇯🇵"</span>, <span class="attr">"🏅"</span>: <span class="string">"27"</span>,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">"序号"</span>: <span class="string">"4"</span>, <span class="attr">"国家"</span>: <span class="string">"🇬🇧"</span>, <span class="attr">"🏅"</span>: <span class="string">"22"</span>,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">"序号"</span>: <span class="string">"5"</span>, <span class="attr">"国家"</span>: <span class="string">"🇷🇺"</span>, <span class="attr">"🏅"</span>: <span class="string">"20"</span>,</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>

<h3 id="5-2-创建比例尺"><a href="#5-2-创建比例尺" class="headerlink" title="5.2 创建比例尺"></a>5.2 创建比例尺</h3><p>在正式画图之前我们先要确认画图的比例尺，比例尺（scale）是D3中很重要的一个概念，举个简单的例子我们为什么需要比例尺。y轴一般用来展示数量的数据，我们预计绘制的图形有200px高，然后y轴的数据在0到10这个范围内，所以需要把0-10映射到0-200像素上面，0对应的高度是0像素，5对应的高度是100像素，10对应200。我们通过下面方法创建一个比例尺。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用线性的比例尺</span></span><br><span class="line"><span class="keyword">const</span> myScale = d3.scaleLinear()</span><br><span class="line">	<span class="comment">// 设置需要映射的范围</span></span><br><span class="line">	.domain([<span class="number">0</span>, <span class="number">10</span>])</span><br><span class="line">	<span class="comment">// 设置映射后的范围</span></span><br><span class="line">	.range([<span class="number">0</span>, <span class="number">200</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69b9efd799a34e019f8803c2c928d1df~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p>由上图可见我们的映射效果，然后神奇的是创建后的比例尺myScale是一个方法，他接受一个需要映射的值返回映射后的值效果<a href="https://codepen.io/WindStormrage/pen/vYZNZzR" target="_blank" rel="noopener">如下</a>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = [<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7.5</span>,<span class="number">9</span>,<span class="number">10</span>]</span><br><span class="line">data.forEach(<span class="function"><span class="params">i</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(myScale(i))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 0 40 60 150 180 200</span></span><br><span class="line">myScale(<span class="number">20</span>) <span class="comment">// 400</span></span><br></pre></td></tr></table></figure>

<p>我们把数字传入创建的myScale就会返回当前对应的位置，既然是比例尺也不会有范围的限制我们传入大于定义时的数字20得到的是符合比例的400。所以使用比例尺我们就可以很好的控制数据的展示位置和展示大小。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8319f2ed9be74869ac9aba3bca460525~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p>上面讲的是非常常用的线性比例尺，D3提供了大约12种不同类型的比例尺，主要分为了四大类。</p>
<ul>
<li>线性数据映射到线性数据，就是我们刚刚说的，在echarts中数值轴和时间轴就是这一类映射。</li>
<li>线性数据映射到离散数据，比如说scaleQuantize，量化比例尺能够吧0到10的连续数据映射到四个颜色上，10被平均分成四段，每一段内返回的是当前段的颜色。具体效果<a href="https://codepen.io/WindStormrage/pen/vYZNjGV" target="_blank" rel="noopener">如下</a>，如果超出两端小于0是返回最左端的颜色，大于10是返回最右端的颜色。</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/287d02dc4f724fd6b07bdfcf847c7454~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d47ec1343e0544049356207f88bb59e0~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<ul>
<li>离散数据映射到线性数据，scaleBand就是接下来做x轴映射的比例尺，我们通常理解为类目轴。效果就从下图就可以看得出来。</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/415cddfa0b714f308b7127822a315a61~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<ul>
<li>离散数据映射到离散数据，其实第三种离散到线性的映射，D3帮助你把映射后的线性数据算成了成离散的相同份数，效果上就是离散到离散的映射。</li>
</ul>
<p>最后回到我们要绘制的图表我们采用scaleLinear作为y轴，scaleBand作为x轴，就很容易的得到下面的代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建比例尺</span></span><br><span class="line"><span class="keyword">const</span> scaleX = d3.scaleBand()</span><br><span class="line">	.domain(data.map(<span class="function"><span class="params">i</span> =&gt;</span> i[xName]))</span><br><span class="line">	.range([<span class="number">0</span>, innerWidth])</span><br><span class="line"><span class="keyword">const</span> scaleY = d3.scaleLinear()</span><br><span class="line">	.domain([<span class="number">0</span>, d3.max(data, i =&gt; i[yName])])</span><br><span class="line">	.range([<span class="number">0</span>, innerWidth])</span><br></pre></td></tr></table></figure>

<h3 id="5-3-创建坐标轴"><a href="#5-3-创建坐标轴" class="headerlink" title="5.3 创建坐标轴"></a>5.3 创建坐标轴</h3><p>比例尺创建了后就接下来就可以绘制出坐标轴了。非常简单，通过d3.axisBttom创建x轴，d3.axisLeft创建y轴，传入比例尺就好。</p>
<p>然后我们创建放置坐标轴的容器（这块的用法在下一步进行讲解）然后通过call方法在容器中添加坐标轴。定义坐标轴返回的xAxis是一个方法，参数是挂载的元素，call方法作用是调用xAxis方法同时传入自身作为参数，同等于调用xAxis传入创建的g。这样就可以渲染出坐标轴了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义坐标轴</span></span><br><span class="line"><span class="keyword">const</span> xAxis = d3.axisBottom(scaleX)</span><br><span class="line"><span class="keyword">const</span> yAxis = d3.axisLeft(scaleY)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加柱图容器, 用来放置坐标轴和后面的图形,</span></span><br><span class="line"><span class="keyword">const</span> bar = d3.select(<span class="string">'svg'</span>)</span><br><span class="line">  .append(<span class="string">'g'</span>)</span><br><span class="line">  .attr(<span class="string">'id'</span>, <span class="string">'bar'</span>)</span><br><span class="line">  .attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;padding&#125;</span>, <span class="subst">$&#123;padding&#125;</span>)`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把坐标轴添加到元素上, g元素用来分组管理</span></span><br><span class="line">bar.append(<span class="string">'g'</span>)</span><br><span class="line">  .call(xAxis)</span><br><span class="line">	.attr(<span class="string">'transform'</span>, <span class="string">`translate(0, <span class="subst">$&#123;innerHeight&#125;</span>)`</span>)</span><br><span class="line">bar.append(<span class="string">'g'</span>)</span><br><span class="line">  .call(yAxis)</span><br><span class="line"><span class="comment">// yAxis(bar.append('g'))</span></span><br></pre></td></tr></table></figure>

<p>聪明的大家肯定会想axisBottom是创建下面的轴，axisLeft是在左边的轴，但是创建的bar元素没有高度怎么能知道下面在哪，其实bottom、left表示的是轴刻度的位置不是坐标轴的位置。是下面，左边。把<a href="https://codepen.io/WindStormrage/pen/bGRVKbw" target="_blank" rel="noopener">四个轴放出来</a>就很清楚了。所以x轴需要设置偏移才能展示正确。</p>
<p>然后又发现y轴反过来了，因为默认原点是左上角，所以需要把y轴的映射domain或者range选一个反着传数据就好了。同时可以加上nice让分割更加均匀。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1566938c202e4a0f8a0d0792f7e251d6~tplv-k3u1fbpfcp-zoom-1.image" alt="img"><br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d2e69d35d994b60882b484a6e39555d~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<h3 id="5-4-绘制图表"><a href="#5-4-绘制图表" class="headerlink" title="5.4 绘制图表"></a>5.4 绘制图表</h3><p>接下来我们开始我们的重头戏，图表的绘制。首先我们了解一下D3中怎么添加元素。</p>
<h5 id="5-4-1-Selected"><a href="#5-4-1-Selected" class="headerlink" title="5.4.1 Selected"></a>5.4.1 Selected</h5><p>可以通过select选择一个元素，selectAll选择多个元素，这两个方法的参数是一个css选择器。就跟jQuery的一样，D3的选择器是可以链式调用的，选择了元素后会返回自身，继续选择或者设置元素的属性。举个<a href="https://codepen.io/WindStormrage/pen/LYLprLw" target="_blank" rel="noopener">例子</a>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="string">'rect'</span>)</span><br><span class="line">	.style(<span class="string">'fill'</span>, <span class="string">'orange'</span>)</span><br><span class="line">	.attr(<span class="string">'width'</span>, <span class="number">40</span>)</span><br><span class="line">	.attr(<span class="string">'height'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d, index</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">10</span> + index * <span class="number">40</span>;</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">d3.select(<span class="string">'rect'</span>)</span><br><span class="line">  .style(<span class="string">'fill'</span>, <span class="string">'pink'</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0eed5a73302445a4a6fc937e1759bbe7~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p>我们可以通过attr设置属性，style设置样式，第一个是设置的属性，第二个参数可以是值，也可以是一个方法，在selectAll时选择的多个元素每一个都会执行一次这个方法，传入当前元素的数据和当前选择元素中的index（元素的的数据在后面说明）这样可以设置每一个元素的样式。</p>
<p>我们一般把select后的值称为Selection，打印Selection后发现他有一个_groups，里面就是我们选择到的元素，调用attr方法时会遍历每一个元素去设置属性。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9870ba8dc9d54d058c11c6fd50998490~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p>selection.append可以添加元素，remove可以删除元素。添加元素后当前的Selection会指向添加后的元素。(<a href="https://codepen.io/WindStormrage/pen/rNwOqQR" target="_blank" rel="noopener">demo</a>)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">  d3.selectAll(<span class="string">'g'</span>)</span><br><span class="line">	  .append(<span class="string">'text'</span>)</span><br><span class="line">  	.text(<span class="string">"A"</span>)</span><br><span class="line">)</span><br><span class="line"><span class="comment">// 打印出group中是新加的text元素</span></span><br></pre></td></tr></table></figure>

<p>在我学到这里的时候我觉得可以画出柱形图了！先创建放柱子的容器，然后循环数据每次循环为一根柱子，分别设置</p>
<ul>
<li>x，y 比例尺算出的位置</li>
<li>width bandwidth是散点比例尺每一项的宽度</li>
<li>height 因为y轴反过来了，所以需要用总高度减去比例尺算出的高度</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> barGroup = bar.append(<span class="string">'g'</span>)</span><br><span class="line">data.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  barGroup</span><br><span class="line">    .append(<span class="string">'rect'</span>)</span><br><span class="line">    .attr(<span class="string">'width'</span>, scaleX.bandwidth)</span><br><span class="line">    .attr(<span class="string">'height'</span>, innerHeight - scaleY(item[yName]))</span><br><span class="line">    .attr(<span class="string">'x'</span>, scaleX(item[xName]))</span><br><span class="line">    .attr(<span class="string">'y'</span>, scaleY(item[yName]))</span><br><span class="line">    .attr(<span class="string">'fill'</span>, <span class="string">'pink'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这是你会发现x轴宽度直接撑满了，非常不美观，所以需要在x的比例尺添加padding，0-1的数。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/43aa74f2fca14863864325df255199d4~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3597b47115654280955c50b54fd39e84~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<p>看起来效果非常的满意，回顾一下难道D3只是帮我操作了SVG的Dom吗？接下来我们来讲讲就是D3的灵魂。</p>
<h5 id="5-4-2-数据驱动"><a href="#5-4-2-数据驱动" class="headerlink" title="5.4.2 数据驱动"></a>5.4.2 数据驱动</h5><p>首先是绑定数据，D3可以帮助你把数据绑定到Dom上，通过selected.datum可以绑定一个数据，通过selected.data可以绑定一串数据。之前用循环实现的柱图可以改写一下。<a href="https://codepen.io/WindStormrage/pen/PojPxrx" target="_blank" rel="noopener">或者看例子</a>。可以看见元素的<strong>data</strong>属性上绑定了对应的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// data绑定实现</span></span><br><span class="line">data.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  barGroup.append(<span class="string">'rect'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">barGroup</span><br><span class="line">  .selectAll(<span class="string">'rect'</span>)</span><br><span class="line">  .data(data)</span><br><span class="line">  .attr(<span class="string">'width'</span>, scaleX.bandwidth)</span><br><span class="line">  .attr(<span class="string">'height'</span>, d =&gt; innerHeight - scaleY(d[yName]))</span><br><span class="line">  .attr(<span class="string">'x'</span>, d =&gt; scaleX(d[xName]))</span><br><span class="line">  .attr(<span class="string">'y'</span>, d =&gt; scaleY(d[yName]))</span><br><span class="line">  .attr(<span class="string">'fill'</span>, <span class="string">'pink'</span>)</span><br></pre></td></tr></table></figure>

<p>看上面的代码虽然说是把数据绑定到了data上，attr通过function的方式就可以拿到数据，绑定data然后通过function的方式应用数据，这就是D3的数据驱动。但是现在的方式前面得循环append矩形，不太友好。接下来我们介绍一种方式自动管理元素的方法。</p>
<h5 id="5-4-3-Data-join"><a href="#5-4-3-Data-join" class="headerlink" title="5.4.3 Data-join"></a>5.4.3 Data-join</h5><p>根据数据渲染元素我们会进行三种操作，如果数据增多会添加(enter)元素，数据减少会删除(exit)元素。如果相等的话元素数量不会更新，只是数据会进行更新(update).</p>
<p>通过data-join可以自动帮我们根据现有元素进行增删改操作，data-join的使用方式如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父容器</span></span><br><span class="line">d3.select(container)</span><br><span class="line">	<span class="comment">// 1.选择现有需要操作的元素</span></span><br><span class="line">  .selectAll(element)</span><br><span class="line">	<span class="comment">// 2.传入数据</span></span><br><span class="line">  .data(array)</span><br><span class="line">	<span class="comment">// 3.根据数据增删指定元素</span></span><br><span class="line">  .join(element);</span><br></pre></td></tr></table></figure>

<p>改写一下我们的线图，只需要在data下面添加join就跟之前的效果一模一样。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// datajoin方式</span></span><br><span class="line">barGroup</span><br><span class="line">  .selectAll(<span class="string">'rect'</span>)</span><br><span class="line">  .data(data)</span><br><span class="line">  .join(<span class="string">'rect'</span>)</span><br><span class="line">  .attr(<span class="string">'width'</span>, scaleX.bandwidth)</span><br><span class="line">  .attr(<span class="string">'height'</span>, d =&gt; innerHeight - scaleY(d[yName]))</span><br><span class="line">  .attr(<span class="string">'x'</span>, d =&gt; scaleX(d[xName]))</span><br><span class="line">  .attr(<span class="string">'y'</span>, d =&gt; scaleY(d[yName]))</span><br><span class="line">  .attr(<span class="string">'fill'</span>, <span class="string">'pink'</span>)</span><br></pre></td></tr></table></figure>

<p>在这个<a href="https://codepen.io/WindStormrage/pen/wveMWQQ?editors=1010" target="_blank" rel="noopener">例子</a>里面，你可以注释或者添加html里面的circle标签，发现使用了join后最后的circle元素始终就是数据个数。</p>
<h5 id="5-4-4-数据更新"><a href="#5-4-4-数据更新" class="headerlink" title="5.4.4 数据更新"></a>5.4.4 数据更新</h5><p>大多数时候数据不是定死的，通常是会跟着时间变化的，在你数据变化的时候data-join并不会监听去改变，所以一般我们会把data-join封装成一个方法，数据变化后去触发。</p>
<p>讲到数据变化就会存在Dom重新渲染的问题，在Vue中我们使用v-for需要加上key防止只修改了一个数据的时候重新修改了整个列表。data-join同样也考虑到了这点，data的第二个参数就接受一个function返回key，在首次渲染的时候肯定是新增元素，在第二次渲染的时候，会通过你的key 方法先检测Dom上之前的数据，然后检测新的数据，通过你的返回值进行匹配，匹配上的就用原来的元素没有就新加（你在key方法里面打log会发现打印出两变，一次是以前的一次是新的）这样有两个小例子可以进去试试 <a href="https://codepen.io/WindStormrage/pen/QWgNQZv" target="_blank" rel="noopener">没加key</a> <a href="https://codepen.io/WindStormrage/pen/KKqzQGv" target="_blank" rel="noopener">加了key</a>，在我们的柱图上也可以改一下试试。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  barGroup</span><br><span class="line">    .selectAll(<span class="string">'rect'</span>)</span><br><span class="line">    .data(data, (d, i) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(d);</span><br><span class="line">    <span class="keyword">return</span> d[xName]</span><br><span class="line">    <span class="keyword">return</span> d[<span class="string">'序号'</span>]</span><br><span class="line">  &#125;)</span><br><span class="line">    .join(<span class="string">'rect'</span>)</span><br><span class="line">    .attr(<span class="string">'width'</span>, scaleX.bandwidth)</span><br><span class="line">    .attr(<span class="string">'height'</span>, d =&gt; innerHeight - scaleY(d[yName]))</span><br><span class="line">    .attr(<span class="string">'x'</span>, d =&gt; scaleX(d[xName]))</span><br><span class="line">    .attr(<span class="string">'y'</span>, d =&gt; scaleY(d[yName]))</span><br><span class="line">    .attr(<span class="string">'fill'</span>, <span class="string">'pink'</span>)</span><br><span class="line">&#125;</span><br><span class="line">update()</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  data = data_0</span><br><span class="line">  update()</span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

<p>数据渲染我封装成了function，定了三秒钟第二次渲染新的数据，我这里有两个return一个是根据序号一个是更新x值，（第二次的序号我打乱了）按道理key值是使用x值才合理，但是我这里用序号效果也是一样的，原因是x轴位置是通过比例尺就算好了的根x值已经绑定了，所以看不出变化，这是就需要添加数据变化的动画看看Dom到底是怎么去改变的。</p>
<h3 id="5-5-添加动画"><a href="#5-5-添加动画" class="headerlink" title="5.5 添加动画"></a>5.5 添加动画</h3><p>于是就引出了本小节，动画非常简单，在需要变化的属性设置前加上transition即可。可以移动添加的位置确定在transition之后的操作才有动画。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在上文join后面加上</span></span><br><span class="line"><span class="comment">//.join('rect')</span></span><br><span class="line">	.transition()</span><br><span class="line">	<span class="comment">// 动画时间，不设置为1s</span></span><br><span class="line">  .duration(<span class="number">2000</span>)</span><br></pre></td></tr></table></figure>

<h3 id="5-6-添加交互"><a href="#5-6-添加交互" class="headerlink" title="5.6 添加交互"></a>5.6 添加交互</h3><p>最后我们的图表还缺少点灵魂就是交互。D3的Selection提供了一个on的方法，允许监听鼠标键盘的事件，这里就跟写Dom的监听事件差不多了。简单的两个事件就可以实现出hover高亮的效果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.on(<span class="string">'mouseenter'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.style.fill = <span class="string">'yellow'</span></span><br><span class="line">&#125;)</span><br><span class="line">  .on(<span class="string">'mouseleave'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.style.fill = <span class="string">'yellowgreen'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="六、来给你看几个厉害的"><a href="#六、来给你看几个厉害的" class="headerlink" title="六、来给你看几个厉害的"></a>六、来给你看几个厉害的</h1><p>到这里我们的D3基本功能就讲完了一大部分了，用这些功能可以做出很多基本的图形了，不过D3的能量远不仅仅于此。下面简单讲几个复杂点的图形。（主要也是我也在学习中只能简单的带大家过一下）</p>
<h3 id="6-1-线图"><a href="#6-1-线图" class="headerlink" title="6.1 线图"></a>6.1 线图</h3><p>线图和柱图不同点是，他是线条需要用path路径来绘制，就是SVG中path元素的d属性，他是由直线曲线等各种命令组成的，不过D3提供了一个path路径的生成工具，大家感兴趣可以去了解<a href="https://d3js.org.cn/document/d3-shape/#installing" target="_blank" rel="noopener">d3-shape</a>的api，线图他提供了d3.line生成，饼图可以使用d3.arc生成。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> line = d3</span><br><span class="line">  .line()</span><br><span class="line">  .x(<span class="function"><span class="params">d</span> =&gt;</span> scaleX(d[Xkey]))</span><br><span class="line">  .y(<span class="function"><span class="params">d</span> =&gt;</span> scaleY(d[Ykey]))</span><br><span class="line"></span><br><span class="line">svg</span><br><span class="line">  .append(<span class="string">'path'</span>).datum(data)</span><br><span class="line">  .attr(<span class="string">'stroke'</span>, <span class="string">'green'</span>)</span><br><span class="line">  .attr(<span class="string">'d'</span>, line)</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e567f2fee74451bb9ad5381e80722b4~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<h3 id="6-2-地图"><a href="#6-2-地图" class="headerlink" title="6.2 地图"></a>6.2 地图</h3><p>地图看上去非常难完成，其实最难的就是找到想要的地图数据了，其实就是根据地图的数据绘制出path路径。可以给大家炫耀一下我学了D3后第一个<a href="http://htmlpreview.github.io/?https://github.com/WindStormrage/UniversityVisualization/blob/master/index.html" target="_blank" rel="noopener">作业</a>。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2cf6a8a6a5d4b40b36f94f0c0fe1b13~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<h3 id="6-3-力导向图"><a href="#6-3-力导向图" class="headerlink" title="6.3 力导向图"></a>6.3 力导向图</h3><p>力导向图用了D3的力布局还有一些作用力，我也还没弄懂就给大家看看<a href="https://bl.ocks.org/mbostock/4062045" target="_blank" rel="noopener">例子</a>吧，还有树图也是用了布局相关的知识。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d17cf23ff964c7f9a1311aa622b0cc0~tplv-k3u1fbpfcp-zoom-1.image" alt="img"><br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd5c100a0125431b9d94d28405d858f5~tplv-k3u1fbpfcp-zoom-1.image" alt="img"></p>
<h1 id="七、Canvas"><a href="#七、Canvas" class="headerlink" title="七、Canvas"></a>七、Canvas</h1><p>D3最重要的部分就是data-join数据绑定了，使用SVG很容易把数据绑定到元素上对他进行属性的更改和更新都很容易。而Canvas画布只有像素点是无状态的。我们选择不了画布上的元素进行更新。对于Canvas的局限性，这里提出了一些解决方案。</p>
<h3 id="7-1-数据绑定"><a href="#7-1-数据绑定" class="headerlink" title="7.1 数据绑定"></a>7.1 数据绑定</h3><p>我们习惯join数据后append对应的元素然后就逐个设置样式，如果是使用Canvas每次更新都需要直接根据全量的数据数据来绘制画布。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</span><br><span class="line">    context.beginPath()....</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>但是在一些元素量非常大的情况下我们只能用Canvas来渲染，一般的解决方法是使用虚拟Dom来模拟data-join，然后我们就可以进行各种D3的操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vDOm = d3.select(<span class="built_in">document</span>.createElement(<span class="string">"custom"</span>));</span><br><span class="line">cosnt bars = vDom.selectAll(<span class="string">".bar"</span>).data(data).enter()....</span><br></pre></td></tr></table></figure>

<p>这个<a href="https://bl.ocks.org/andrew-reid/318d19505c3665d214022ad359124605" target="_blank" rel="noopener">例子</a>就是在Canvas中模拟data-join的过程。</p>
<h3 id="7-2-交互事件"><a href="#7-2-交互事件" class="headerlink" title="7.2 交互事件"></a>7.2 交互事件</h3><p>Canvas最主要的问题是无状态，鼠标的交互只能获取在Canvas上的位置，没有元素的概念。不过也有几种方式去模拟点击元素的操作。</p>
<ol>
<li>用四叉树来记录所有元素的位置然后根据点击的点去遍历。</li>
<li>在d3-force的布局中提供了.find方法，可以找到最接近鼠标点击的节点。</li>
<li>非常巧妙的办法，创建一个一样的画布，每个元素渲染一种颜色，通过点击到的像素点的颜色确定点击到的是那个元素。</li>
</ol>
<p>ECharts主要也是用Canvas渲染，ECharts 使用的是 ZRender 底层渲染器。ZRender 提供了三种渲染器，分别是 Canvas，SVG 和 VML。下面是原文，总结一下就是根据鼠标位置计算出当前指向的元素。</p>
<blockquote>
<p>在判断事件将被哪个图形元素响应的时候，我们会反向循环渲染列表，也就是先判断鼠标是否在位于屏幕前面的图形内。判断的时候，会先将鼠标坐标变换到图形坐标系。这是因为图形可能是经过平移旋转缩放的，甚至图形与图形之间还可能有组合的变换。将鼠标变换到图形坐标系后，我们就可以知道两者的相对关系，然后先根据包围盒做粗略的判断，再根据路径做精确的判断。如果鼠标在该图形内，则让这个图形进行事件分发与冒泡，如果不在，则对位于屏幕后方的元素一一判断。</p>
</blockquote>
<p>这里有两种方式的实现demo，<a href="https://bl.ocks.org/mbostock/4062045" target="_blank" rel="noopener">SVG</a>、<a href="https://bl.ocks.org/mbostock/ad70335eeef6d167bc36fd3c04378048" target="_blank" rel="noopener">Canvas</a></p>
<h3 id="7-3-api支持"><a href="#7-3-api支持" class="headerlink" title="7.3 api支持"></a>7.3 api支持</h3><p>D3的大部分模块不是和Dom进行交互的比如说d3-hierarchy用来绘制层级结构的图就只是给出了每个点的位置和每条线的路径。</p>
<p>对于d3-selection、d3-transition模块我们可以通过操作虚拟Dom来转换成Canvas。</p>
<p>对于d3-axis就跟SVG强相关，他会自动帮你构建SVG的坐标轴，这就没办法了。</p>
<p>d3-path来绘制线图饼图地图非常有用，不过D3也允许提供一个context可以帮你绘制在Canvas画布上。<a href="https://bl.ocks.org/mbostock/8878e7fd82034f1d63cf" target="_blank" rel="noopener">demo</a></p>
<h1 id="八、一些链接"><a href="#八、一些链接" class="headerlink" title="八、一些链接"></a>八、一些链接</h1><p>The Hitchhiker’s Guide to D3.js：<a href="https://medium.com/@enjalot/the-hitchhikers-guide-to-d3-js-a8552174733a" target="_blank" rel="noopener">原文</a> <a href="https://juejin.cn/post/6844903619548938247#heading-5" target="_blank" rel="noopener">翻译</a></p>
<p>How Selections Work：<a href="https://bost.ocks.org/mike/selection/" target="_blank" rel="noopener">原文</a> <a href="https://juejin.cn/post/6844903629611089927" target="_blank" rel="noopener">翻译</a></p>
<p><a href="https://www.d3indepth.com/introduction/" target="_blank" rel="noopener">D3 in Deoth</a></p>
<p><a href="https://github.com/WindStormrage/my_d3_demo" target="_blank" rel="noopener">我学习过程中的一些demo</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8D%95%E6%8C%87%E7%A7%BB%E5%8A%A8%E5%92%8C%E5%8F%8C%E6%8C%87%E7%BC%A9%E6%94%BE%E7%9A%84%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8D%95%E6%8C%87%E7%A7%BB%E5%8A%A8%E5%92%8C%E5%8F%8C%E6%8C%87%E7%BC%A9%E6%94%BE%E7%9A%84%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">移动端单指移动和双指缩放的实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-29 16:11:45 / 修改时间：16:45:58" itemprop="dateCreated datePublished" datetime="2020-12-29T16:11:45+08:00">2020-12-29</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在前段时间公司内部的一个比赛上做了一个找工位的小项目，既然是找工位就得有工位的地图，本来是想着用建模的工具来把工位的模型建出来然后放在地图插件上，然后因为工作量，性能等原因没有继续思考下去了。</p>
<p>梳理了一下需求无非就是需要实现出<strong>单指拖动</strong>，<strong>单指点击</strong>，<strong>双指缩放</strong>的效果，然后底下放一张图片来充当地图，然后记录下当前的位移和缩放，就可以算出点击的位置，然后把工位的坐标遍历一下就可以知道点击的是哪个工位了。</p>
<p>开始以为非常的简单就可以实现出来，然后在项目的过程中遇到了很多的问题，然后项目完成后我就把拖动和缩放单独抽了出来，在这里我讲一下我的思路和遇到的问题。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/12/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8D%95%E6%8C%87%E7%A7%BB%E5%8A%A8%E5%92%8C%E5%8F%8C%E6%8C%87%E7%BC%A9%E6%94%BE%E7%9A%84%E5%AE%9E%E7%8E%B0/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/28/canvas%E9%94%A5%E5%BD%A2%E6%B8%90%E5%8F%98%E8%BF%9B%E5%BA%A6%E6%9D%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/28/canvas%E9%94%A5%E5%BD%A2%E6%B8%90%E5%8F%98%E8%BF%9B%E5%BA%A6%E6%9D%A1/" class="post-title-link" itemprop="url">canvas锥形渐变进度条</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-28 16:41:00" itemprop="dateCreated datePublished" datetime="2020-05-28T16:41:00+08:00">2020-05-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-21 17:59:16" itemprop="dateModified" datetime="2020-10-21T17:59:16+08:00">2020-10-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="从一个渐变圆角进度条浅出画一个圆"><a href="#从一个渐变圆角进度条浅出画一个圆" class="headerlink" title="从一个渐变圆角进度条浅出画一个圆"></a>从一个渐变圆角进度条浅出画一个圆</h1><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>这一切需要从一个（简单）的需求开始，在最开始对设计第一眼看到这张图的时候，感觉挺简单的嘛，直接用echarts饼图模拟出来一个就好了</p>
<p><img src="https://i.postimg.cc/G27rj13p/t0161cd9dfa2f5a7997.png" alt="image"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/05/28/canvas%E9%94%A5%E5%BD%A2%E6%B8%90%E5%8F%98%E8%BF%9B%E5%BA%A6%E6%9D%A1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9C%80%E6%B1%82%E4%B9%8B%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9C%80%E6%B1%82%E4%B9%8B%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="post-title-link" itemprop="url">文件上传需求之大文件上传</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-29 01:42:00" itemprop="dateCreated datePublished" datetime="2020-03-29T01:42:00+08:00">2020-03-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-10 19:17:53" itemprop="dateModified" datetime="2020-04-10T19:17:53+08:00">2020-04-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>本文主要是讲了菜鸡作者（我）在面对文件上传的需求的时候的一些解决方法，如果有问题或者有更好的方法欢迎大家指出。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/03/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%9C%80%E6%B1%82%E4%B9%8B%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/18/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/18/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Docker学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-18 16:59:00" itemprop="dateCreated datePublished" datetime="2018-12-18T16:59:00+08:00">2018-12-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-09 16:08:41" itemprop="dateModified" datetime="2020-04-09T16:08:41+08:00">2020-04-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Docker介绍"><a href="#Docker介绍" class="headerlink" title="Docker介绍"></a>Docker介绍</h2><p>最近花了点时间学习了一下docker，发现docker还是挺好用的，学了后也在实际中使用到了，就是一个静态页面需要跑在服务器上查看效果，如果用node跑的话还需要在项目中加上其他项目中没有用到的东西，然后用nginx的话还需要写个nginx的配置文件，如果在你的文件夹里面还需要设置权限，都比较麻烦，然后我就直接用上了docker，在之前使用docker的时候也装上过nginx的docker镜像，然后就只需要一条命令创建一个nginx的容器，然后把目标目录挂载到nginx上就可以访问到了，然后每次打开只需要docker start一下就好了，非常方便。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/12/18/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/08/nginx%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/08/nginx%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">nginx学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-08 15:05:00" itemprop="dateCreated datePublished" datetime="2018-12-08T15:05:00+08:00">2018-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-09 16:35:43" itemprop="dateModified" datetime="2020-04-09T16:35:43+08:00">2020-04-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="nginx-安装"><a href="#nginx-安装" class="headerlink" title="nginx 安装"></a>nginx 安装</h2><p>直接用brew安装，没有brew的自行安装</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/12/08/nginx%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/vue%E9%87%87%E7%94%A8history%E8%B7%AF%E7%94%B1%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/21/vue%E9%87%87%E7%94%A8history%E8%B7%AF%E7%94%B1%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">vue采用history路由的服务器部署问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-06-21 23:21:00" itemprop="dateCreated datePublished" datetime="2018-06-21T23:21:00+08:00">2018-06-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-09 16:35:28" itemprop="dateModified" datetime="2020-04-09T16:35:28+08:00">2020-04-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="发现部署问题"><a href="#发现部署问题" class="headerlink" title="发现部署问题"></a>发现部署问题</h2><p>在部署的时候发现打开的页面是空白</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/06/21/vue%E9%87%87%E7%94%A8history%E8%B7%AF%E7%94%B1%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/12/%E6%88%91%E6%98%AF%E6%80%8E%E4%B9%88%E6%90%9E%E6%87%82%E9%97%AD%E5%8C%85%E7%9A%84%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/12/%E6%88%91%E6%98%AF%E6%80%8E%E4%B9%88%E6%90%9E%E6%87%82%E9%97%AD%E5%8C%85%E7%9A%84%EF%BC%9F/" class="post-title-link" itemprop="url">我是怎么搞懂闭包的？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-06-12 17:26:00" itemprop="dateCreated datePublished" datetime="2018-06-12T17:26:00+08:00">2018-06-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-09 16:34:56" itemprop="dateModified" datetime="2020-04-09T16:34:56+08:00">2020-04-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="先从一个简单的闭包开始"><a href="#先从一个简单的闭包开始" class="headerlink" title="先从一个简单的闭包开始"></a>先从一个简单的闭包开始</h2><p>想从函数外部访问到函数内部的变量，当然是不可以访问的，但是你如果在这个函数里面返回一个方法用来对这个函数里面的变量进行操作的话，就可以像是在外面访问量函数内的变量（其实我暂时是认为没有访问函数里面变量的，实质上只是调用了对相应参数进行操作的方法），举个栗子把</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/06/12/%E6%88%91%E6%98%AF%E6%80%8E%E4%B9%88%E6%90%9E%E6%87%82%E9%97%AD%E5%8C%85%E7%9A%84%EF%BC%9F/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/29/%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%8D%95%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/29/%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%8D%95%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8/" class="post-title-link" itemprop="url">动手实现一个单页面应用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-05-29 16:09:00" itemprop="dateCreated datePublished" datetime="2018-05-29T16:09:00+08:00">2018-05-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-09 16:33:39" itemprop="dateModified" datetime="2020-04-09T16:33:39+08:00">2020-04-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在单页面应用程序中，前后端采用了完全分离的方法，因此在前端实现路由的切换非常的重要。同时前端实现路由可以减少请求数，缓解后端的压力。在单页面中的路由主要有两种实现方法，一种是通过h5的history api来实现，还有一种是hash来实现。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/05/29/%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%8D%95%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/24/%E5%AF%B9vue%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E7%9A%84%E6%80%9D%E8%80%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon-logo.png">
      <meta itemprop="name" content="WindStormrage">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WindStormrage Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/24/%E5%AF%B9vue%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E7%9A%84%E6%80%9D%E8%80%83/" class="post-title-link" itemprop="url">对vue双向绑定的思考</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-05-24 20:27:00" itemprop="dateCreated datePublished" datetime="2018-05-24T20:27:00+08:00">2018-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-09 16:35:59" itemprop="dateModified" datetime="2020-04-09T16:35:59+08:00">2020-04-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="对于数组"><a href="#对于数组" class="headerlink" title="对于数组"></a>对于数组</h3><p>直接更改数组里面的项的值是不会有view响应的，如：</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/05/24/%E5%AF%B9vue%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E7%9A%84%E6%80%9D%E8%80%83/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="WindStormrage"
      src="/images/favicon-logo.png">
  <p class="site-author-name" itemprop="name">WindStormrage</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/WindStormrage" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;WindStormrage" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:695729033@qq.com" title="E-Mail → mailto:695729033@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WindStormrage</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
